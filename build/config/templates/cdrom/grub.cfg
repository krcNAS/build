#
# DO NOT EDIT THIS FILE
#
# It is automatically generated by grub-mkconfig using templates
# from /usr/local/etc/grub.d and settings from /usr/local/etc/default/grub
#

### BEGIN /usr/local/etc/grub.d/00_header ###
if [ -s $$prefix/grubenv ]; then
  load_env
fi
set default="0"

if [ x"$${feature_menuentry_id}" = xy ]; then
  menuentry_id_option="--id"
else
  menuentry_id_option=""
fi

export menuentry_id_option

if [ "$${prev_saved_entry}" ]; then
  set saved_entry="$${prev_saved_entry}"
  save_env saved_entry
  set prev_saved_entry=
  save_env prev_saved_entry
  set boot_once=true
fi

function savedefault {
  if [ -z "$${boot_once}" ]; then
    saved_entry="$${chosen}"
    save_env saved_entry
  fi
}

function load_video {
  insmod vbe
  insmod vga
  insmod video_bochs
  insmod video_cirrus
}

# If on a PC / BIOS platform
if [ x"${grub_platform}" = xpc ] ; then
  set gfxmode=auto
  load_video
  insmod gfxterm
  kernvt="sc"
  terminal_output console
else
  # EFI
  insmod efi_gop
  insmod gfxterm
  insmod font
  insmod videotest
  insmod videoinfo
  kernvt="vt"
  terminal_output gfxterm
  insmod gfxmenu
  insmod png
  loadfont ($root)/boot/grub/themes/starfield/dejavu_10.pf2
  loadfont ($root)/boot/grub/themes/starfield/dejavu_12.pf2
  loadfont ($root)/boot/grub/themes/starfield/dejavu_14.pf2
  loadfont ($root)/boot/grub/themes/starfield/dejavu_16.pf2
  loadfont ($root)/boot/grub/themes/starfield/dejavu_bold_14.pf2
fi

set timeout=15

menuentry "${PRODUCT} Installer" {
  kfreebsd /boot/kernel/kernel
  kfreebsd_loadenv /boot/device.hints
  set kFreeBSD.vfs.root.mountfrom=cd9660:/dev/iso9660/${CDROM_LABEL}
  set kFreeBSD.xconsole=YES
  set kFreeBSD.kern.vty=$kernvt
  set kFreeBSD.grub.platform=$grub_platform

  # These are manually synced from loader.conf.
  # Look for describing comments there.
  set kFreeBSD.vfs.mountroot.timeout=180
  set kFreeBSD.vfs.zfs.vol.mode=2
  set kFreeBSD.kern.geom.label.disk_ident.enable="0"
  set kFreeBSD.hint.ahciem.0.disabled="1"
  set kFreeBSD.hint.ahciem.1.disabled="1"
  set kFreeBSD.kern.msgbufsize="524288"
  set kFreeBSD.hw.mfi.mrsas_enable="1"
  set kFreeBSD.hw.usb.no_shutdown_wait=1
}

menuentry "${PRODUCT} Installer (Serial Enabled)" {
  kfreebsd /boot/kernel/kernel -Dh
  kfreebsd_loadenv /boot/device.hints
  set kFreeBSD.vfs.root.mountfrom=cd9660:/dev/iso9660/${CDROM_LABEL}
  set kFreeBSD.xconsole=YES
  set kFreeBSD.kern.vty=$kernvt
  set kFreeBSD.grub.platform=$grub_platform
  set kFreeBSD.hw.uart.console="io:0x3f8,br:115200"

  # These are manually synced from loader.conf.
  # Look for describing comments there.
  set kFreeBSD.vfs.mountroot.timeout=180
  set kFreeBSD.vfs.zfs.vol.mode=2
  set kFreeBSD.kern.geom.label.disk_ident.enable="0"
  set kFreeBSD.hint.ahciem.0.disabled="1"
  set kFreeBSD.hint.ahciem.1.disabled="1"
  set kFreeBSD.kern.msgbufsize="524288"
  set kFreeBSD.hw.mfi.mrsas_enable="1"
  set kFreeBSD.hw.usb.no_shutdown_wait=1
}
